Spark The Definitive Guide 

18.5.8 드라이버 OutOfMemoryError 또는 응답 없음

드라이버에 너무 많은 데이터를 전송해 메모리를 모두 소비한 경우 자주 발생

징후와 증상
* 스파크 애플리케이션이 응답하지 않거나 비정상적으로 종료됨
* 드라이버 로그에 OOM 또는 가비지 컬렉션과 관련된 메시지가 출력됨
* 명령이 장시간 실행되거나 실행되지 않음
* 반응이 거의 없음
* 드라이버 JVM의 메모리 사용량이 많음


잠재적 대응법
* collect 와 같은 연산을 실행해 너무 큰 데이터셋을 드라이버에 전송하려고 시도했을 때
* 너무 큰 데이터를 브로드캐스트 조인에 사용
* 장시간 실행되는 앱은 드라이버에 많은 양의 객체를 생성해 해제하지 못 할 수 있음
자바의 jmap: 힙 메모리의 히스토그램 확인할 수 있음
드라이버 JVM의 메모리를 가장 많이 차지하는 객체를 찾는데 유용.
하지만 jmap 실행 시 JVM이 잠시 중단 될 수 있음

* 가능하면 드라이버의 가용 메모리를 증가시키기
* JVM 메모리 부족 현상은 다른 언어를 함께 사용하는 경우 발생 가능.
두 언어 간의 데이터 변환 과정에서 과도한 메모리를 사용하기 때문.
더 적은 양의 데이터를 전송해보거나
드라이버 메모리에 모으지 않고 파일로 저장
* 다른 사용자와 SparkContext를 공유하는 상황이라면 여러 사용자가 동시에 대량의 데이터를 
드라이버 메모리로 전송할 수 있는 명령을 실행하지 못하도록 막아야 함.
